# 第一章 密码学介绍

<!-- cryptography:密码学； -->

密码（cryptography）是一个极其庞大复杂的信息处理体系，涉及到信息的机密性、完整性、认证、不可否认性等众多方面，由此衍生出的很多保护我们信息安全的技术，这些技术我们一般统称为密码技术。密码技术是密码学的核心。

密码学是网络安全、信息安全、区块链等领域的基础，常见的对称密码、公钥密钥、散列函数等，都属于密码学范畴。密码学中的密码技术比如“密码”可以让窃听者无法解读窃取的信息，“单项散列函数”可以检测出消息是否被篡改，“数字签名”可以确定消息是否来源于合法的发送者。

## 1.1 密码学发展史

可将密码学的发展史总体分为四个阶段：远古密码学 --> 古典密码学 --> 近代密码学 --> 现代密码学。

**远古密码学**

这个时期所谓“密码”本质上是古人根据物理工具特性所作出的改造和伪装，当中并没有涉及到启发式的数学思维或方法，我们称之为远古密码。该阶段有：姜子牙的阴符、阴书、塞塔密码、隐语等等。

**古典密码学**

古典密码编码方法的核心是代替和置换。常见的有：凯撒密码、棋盘密码、圆盘密码、维吉尼亚密码、栅栏密码。

**近代密码学**

近代密码学是20世纪初到20世纪50年代，包含1战和2战时期。随着密码机的迅速发展，越来越多的数学家加入密码队伍。该阶段的密码有：Playfair密码、一次性便笺密码、恩尼格玛密码、JN-25密码等等。

**现代密码学**

现代密码学是从1949年至今，自此数据的安全基于密钥而不是算法的保密。1949年信息论创始人Shannon香农发表划时代论文《The Communication Theory of Secret Systems》，其中定义了理论安全性，提出扩散和混淆原则。奠定了现代密码学的理论基础。

## 1.2 重要概念

将明文通过处理变换为密文的规则称为加密算法，将密文恢复成明文的规则称为解密算法，加密解密一起称为密码算法。

- 明文 (Plaintext)： 信息的原始数据
- 密文(Ciphertext)：明文经过编码变换所生成的数据
- 加密(Encryption)：对明文进行编码变换生成密文的过程
- 解密(Decryption)：将密文恢复成明文的过程
- 密钥：密码算法需要用到密钥的，密钥就相当于保险库大门的钥匙，重要性不言而喻，所以切记不要泄露密码的密钥。密钥 (Key)：控制明文与密文之间相互变换的，分为加密密钥和解密密钥。

# 第二章 编码算法

编码算法并不是加密与解密，它知识为了在网络间更方便的传输数据而产生。

## 2.1 ASCII编码

在计算机的内部都是二进制的0、1数据，如何让计算机可以直接识别人类文字的问题呢？就产生出了编码表的概念。

编码表 ：就是将人类的文字和一个十进制数进行对应起来组成一张表格。

将所有的英文字母，数字，符号都和十进制进行了对应，因此产生了世界上第一张编码表ASCII（American Standard Code for Information Interchange 美国标准信息交换码）。

| 字符 | 数值 |
| ---- | ---- |
| 0    | 48   |
| 9    | 57   |
| A    | 65   |
| Z    | 90   |
| a    | 97   |
| z    | 122  |

```java
public static void main(String[] args) {
    // 字符类型变量
    char c = 'a';
    int i = 1;
    // 字符类型和int类型计算
    System.out.println(c + i);// 输出结果是98
}
```

在char类型和int类型计算的过程中，char类型的字符先查询编码表，得到97，再和1求和，结果为98。char类型提升 为了int类型。char类型内存2个字节，int类型内存4个字节。

ASCII码大致可以分作三部分组成。

- 第一部分是 ASCII 非打印控制字符。ASCII 表上的数字 0–31 分配给了控制字符，用于控制像打印机等一些外围设备。例如，12 代表换页/新页功能。此命令指示打印机跳到下一页的开头。

  ![](D:\Java\笔记\图片\6-00【通用基础知识】\ASCII码0_31.png)

- 第二部分是 ASCII 打印字符。数字 32–126 分配给了能在键盘上找到的字符，当您查看或打印文档时就会出现。数字127代表 DELETE 命令。

  ![](D:\Java\笔记\图片\6-00【通用基础知识】\ASCII码32_127.gif)

- 第三部分是扩展 ASCII 打印字符。扩展的ASCII字符满足了对更多字符的需求

  ![](D:\Java\笔记\图片\6-00【通用基础知识】\ASCII扩展码128_255.gif)

## 2.2 Hex编码

计算机中的字节共有256个组合（1字节 = 8bit = 2^8组合），对应就是ascii码，而ascii码的128～255之间的值是不可见字符。在网络上交换数据时，往往要经过多个路由设备，由于不同的设备对字符的处理方式有一些不同，这样那些不可见字符就有可能被处理错误，这是不利于传输的。所以我们需要将字节转为正确的可见字符，需要对字节数组进行进一步编码，常用编码格式有 Hex 编码和 Base64 编码。

Hex 编码是将数据转换成符合 Intel Hex 文件格式的一种编码方式，Hex 编码的最小单位是 1Byte 也即 8 个 bit 位。

Hex编码的原理就是将原来8位的二进制字节打断，分成两个4位的，并且在前面加上4个零，进行补位这样一个8位二进制字节就变成了2个8位的二进制字节，在将新得到的2个二进制字符进行16位进制转换，得到的新的16位字符串就是 Hex 的值。Hex 编码后的数据大小是原来的 2 倍

```apl
字符串：                    HEX
ASCII码：                  [72,69,88]
二进制码：                  ‭01001000‬ ‭01000101‬ ‭01011000‬
重新分组：                  0100 1000 0100 0101 0101 1000
高位补零后的二进制码：       00000100 00001000 00000100 00000101 00000101 00001000
十六进制码：                       4        8        4        5        5        8
Hex码：                    484558
```

```xml
<dependency>
    <groupId>commons-codec</groupId>
    <artifactId>commons-codec</artifactId>
    <version>1.10</version>
</dependency>
```

```java
@Test
public void test01() {
    // 一个字符串
    String hex = "HEX";
    // 获取字符串的byte数组 
    byte[] buf = hex.getBytes();
    // 输出byte数组 [72, 69, 88]
    System.out.println(Arrays.toString(buf));
    // 转换成Hex输出 484558
    System.out.println(Hex.encodeHexString(buf));
}
```

## 2.2 Base64编码

Base64 是网络中存储和传输的二进制数据的普遍用法。Base64 一个字节只能表示 64 种情况，且编码格式每个字节的前两位都只能是 0，使用剩下的 6 位表示内容。内容由A-Z、a-z、0-9、+、/共64个字符组成。如果去掉i、I、o、O、+、/就变成了另一种编码，即base58。

编码规则：

1. 将每 3 个字节作为一组，3 个字节一共 24 个二进制位，如果有多余的字节用=补位
2. 将这 24 个二进制位分为 4 组，每个组有 6 个二进制位
3. 在每组的 6 个二进制位前面补两个 00，扩展成 32 个二进制位，即四个字节
4. 每个字节对应的将是一个小于 64 的数字，即为字符编号
5. 再根据字符索引关系表，每个字符编号对应一个字符，就得到了 Base64 编码字符

```apl
字符：                 y                o              u                       r
ASCII码：             121              111            117                     114
二进制位：          0111 1001      0110 1111      0111 0101                0111 0010
编码字节：   00 011110    00 010110    00 111101      00 110101      0001 1100    0010 0000
索引编号:      30            22            61            53             28           32
Base64编码：   e             w             9             1              c            g          ==
```

| **索引** | **对应字符** | **索引** | **对应字符** | **索引** | **对应字符** | **索引** | **对应字符** |
| -------- | ------------ | -------- | ------------ | -------- | ------------ | -------- | ------------ |
| 0        | **A**        | 17       | **R**        | 34       | **i**        | 51       | **z**        |
| 1        | **B**        | 18       | **S**        | 35       | **j**        | 52       | **0**        |
| 2        | **C**        | 19       | **T**        | 36       | **k**        | 53       | **1**        |
| 3        | **D**        | 20       | **U**        | 37       | **l**        | 54       | **2**        |
| 4        | **E**        | 21       | **V**        | 38       | **m**        | 55       | **3**        |
| 5        | **F**        | 22       | **W**        | 39       | **n**        | 56       | **4**        |
| 6        | **G**        | 23       | **X**        | 40       | **o**        | 57       | **5**        |
| 7        | **H**        | 24       | **Y**        | 41       | **p**        | 58       | **6**        |
| 8        | **I**        | 25       | **Z**        | 42       | **q**        | 59       | **7**        |
| 9        | **J**        | 26       | **a**        | 43       | **r**        | 60       | **8**        |
| 10       | **K**        | 27       | **b**        | 44       | **s**        | 61       | **9**        |
| 11       | **L**        | 28       | **c**        | 45       | **t**        | 62       | **+**        |
| 12       | **M**        | 29       | **d**        | 46       | **u**        | 63       | **/**        |
| 13       | **N**        | 30       | **e**        | 47       | **v**        |          |              |
| 14       | **O**        | 31       | **f**        | 48       | **w**        |          |              |
| 15       | **P**        | 32       | **g**        | 49       | **x**        |          |              |
| 16       | **Q**        | 33       | **h**        | 50       | **y**        |          |              |